<body class="container">
<h1><%= @resort.name %></h1>
<div><%= image_tag @resort.photo.large %></div>
 <p>Weekly weather forecast:</p>



 <table>
  <thead>
    <tr>
      <th>When</th>
      <th>Temp Low</th>
      <th>Temp High</th>
      <th>Snow Probability</th>
      <th>Inches of Snow</th>
      <th>Summary</th>
    </tr>
  </thead>
  <tbody>

   <% @resort.hourly_forecasts.sort_by(&:datetime).each do |forecast| %>
     <tr>
       <td ><%= forecast.datetime.strftime("%A, %b %d") %></td>
       <td ><%= forecast.temperature_min.round(0) %></td>
       <td ><%= forecast.temperature_max.round(0) %></td>
       <td ><%= number_to_percentage forecast.precip_probability * 100, precision: 0 %></td>
       <td ><%= forecast.precip_accumulation.round(1) %></td>
       <td ><%= forecast.summary %></td>
     </tr>
   <% end %>

  </tbody>
  </table>


<% total = @resort.hourly_forecasts.map do |forecast| %>
  <% forecast.precip_accumulation.to_f %>
<% end %>
<h4>Expected snowfall this week: <%= total.sum.round(2) %> inches</h4>


<p><%= link_to "Buy a flight to #{@resort.name}", "http://www.google.com/flights" %></p>


<table>
 <thead>
   <tr>
     <th>Destination</th>
     <th>Airline</th>
     <th>One-way Price</th>
     <th>Carrier</th>
     <th>Flight #</th>
   </tr>
 </thead>
 <tbody>

<% @flight.each do |fly| %>
  <tr>
    <td ><%= fly.destination %></td>
    <td ><%= fly.carrier_name %></td>
    <td ><%= number_to_currency(fly.price) %></td>
    <td ><%= fly.carrier_code %></td>
    <td ><%= fly.flight_number %></td>
  </tr>
<% end %>

</tbody>
</table>

</body>
