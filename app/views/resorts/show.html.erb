<body class="container">
<h1><%= @resort.name %></h1>
<div><%= image_tag @resort.photo.large %></div>
 <p>Weekly weather forecast:</p>



 <table class="temp table-bordered table-condensed table-striped" style="width: 100%">
  <thead>
    <tr>
      <th>When</th>
      <th>Temp Low</th>
      <th>Temp High</th>
      <th>Snow Probability</th>
      <th>Inches of Snow</th>
      <th>Summary</th>
    </tr>
  </thead>
  <tbody>

   <% @resort.hourly_forecasts.sort_by(&:datetime).each do |forecast| %>
     <tr>
       <td ><%= forecast.datetime.strftime("%A, %b %d") %></td>
       <td ><%= forecast.temperature_min.round(0) %></td>
       <td ><%= forecast.temperature_max.round(0) %></td>
       <td ><%= number_to_percentage forecast.precip_probability * 100, precision: 0 %></td>
       <td ><%= forecast.precip_accumulation.round(1) %></td>
       <td ><%= forecast.summary %></td>
     </tr>
   <% end %>

  </tbody>
  </table>


<% total = @resort.hourly_forecasts.map do |forecast| %>
  <% forecast.precip_accumulation.to_f %>
<% end %>
<h2>Expected snowfall this week: <%= total.sum.round(2) %> inches</h2>


<table  class="flight table-bordered table-condensed table-striped" style="width: 100%">
 <thead>
   <tr>
     <th>Destination</th>
     <th>Airline</th>
     <th>One-way Price</th>
     <th>Carrier</th>
     <th>Flight #</th>
     <th>Link</th>
   </tr>
 </thead>
 <tbody>
<% flights_for_resort(flights: @flight, resort: @resort).each do |fly| %>
  <tr>
    <td ><%= fly.destination %></td>
    <td ><%= fly.carrier_name %></td>
    <td ><%= number_to_currency(fly.price) %></td>
    <td ><%= fly.carrier_code %></td>
    <td ><%= fly.flight_number %></td>
    <td ><%= link_to "Fly to #{@resort.name} now", "http://www.google.com/flights" %></td>
  </tr>
<% end %>

</tbody>
</table>
<br>
<div>
  <%= link_to "Get to #{@resort.name} - Flight leaves tomorrow! ", href= "http://www.google.com/flights", class: "btn btn-success", style: "width: 100%" %>
</div>
<br>
<br>
<br>
</body>
