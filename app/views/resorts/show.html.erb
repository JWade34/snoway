<nav class="navbar navbar-default">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand">SnowFly</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li class="active"> <%= link_to "Home", root_path %> <span class="sr-only">(current)</span></li>
      </ul>
      <ul class="nav navbar-nav">
        <li class="active"> <%= link_to "All Flights", flight_path %> <span class="sr-only">(current)</span></li>
      </ul>

      <form class="navbar-form navbar-left" role="search">
        <%= form_tag root_path, method: :get do %>
        <%= text_field_tag :search_text %>
        <%= submit_tag "Search", class: "btn btn-default" %>
        <% end %>
      </form>

      <ul class="nav navbar-nav navbar-right">
        <button type="button" class="navbar-btn btn btn-primary" data-toggle="modal" data-target=".bs-example-modal-sm">Get Weekly Snowfall Email</button>
        <div class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-sm">
            <div class="modal-content">
              <%= render partial:  'users/form' %>
            </div>
          </div>
        </div>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

<body class="show container">
<h1><%= @resort.name %></h1>
<div><%= image_tag @resort.photo.large, class: "img-responsive" %></div>
 <p>Weekly weather forecast:</p>



 <table class="temp table-bordered table-condensed table-striped" style="width: 100%">
  <thead>
    <tr>
      <th>When</th>
      <th>Temp Low</th>
      <th>Temp High</th>
      <th>Snow Probability</th>
      <th>Inches of Snow</th>
      <th>Summary</th>
    </tr>
  </thead>
  <tbody>

   <% @resort.hourly_forecasts.sort_by(&:datetime).each do |forecast| %>
     <tr>
       <td ><%= forecast.datetime.strftime("%A, %b %d") %></td>
       <td ><%= forecast.temperature_min.round(0) %></td>
       <td ><%= forecast.temperature_max.round(0) %></td>
       <td ><%= number_to_percentage forecast.precip_probability * 100, precision: 0 %></td>
       <td ><%= forecast.precip_accumulation.round(1) %></td>
       <td ><%= forecast.summary %></td>
     </tr>
   <% end %>

  </tbody>
  </table>


<% total = @resort.hourly_forecasts.map do |forecast| %>
  <% forecast.precip_accumulation.to_f %>
<% end %>
<h2>Expected snowfall this week: <%= total.sum.round(2) %> inches</h2>


<table  class="flight table-bordered table-condensed table-striped" style="width: 100%">
 <thead>
   <tr>
     <th>Destination</th>
     <th>Airline</th>
     <th>One-way Price</th>
     <th>Carrier</th>
     <th>Flight #</th>
     <th>Link</th>
   </tr>
 </thead>
 <tbody>
<% flights_for_resort(flights: @flight, resort: @resort).each do |fly| %>
  <tr>
    <td ><%= fly.destination %></td>
    <td ><%= fly.carrier_name %></td>
    <td ><%= number_to_currency(fly.price) %></td>
    <td ><%= fly.carrier_code %></td>
    <td ><%= fly.flight_number %></td>
    <td ><%= link_to "Fly to #{@resort.name} now", "http://www.google.com/flights" %></td>
  </tr>
<% end %>

</tbody>
</table>
<br>
<div>
  <%= link_to "Get to #{@resort.name} - Flight leaves tomorrow! ", href= "http://www.google.com/flights", class: "btn btn-success", style: "width: 100%" %>
</div>
<br>
<br>
<br>
</body>
